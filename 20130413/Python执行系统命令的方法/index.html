<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="(1) os.system# 仅仅在一个子终端运行系统命令，而不能获取命令执行后的返回信息system(command) -&amp;gt; exit_statusExecute the command (a string) in a subshell.# 如果再命令行下执行，结果直接打印出来1234&amp;gt"><meta name="author" content="whypro"><meta property="og:title" content="Python执行系统命令的方法"><meta property="og:site_name" content="Everlasting"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><title>Python执行系统命令的方法 - Everlasting</title><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous"><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"><!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]--><link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"><link rel="stylesheet" href="/hexo-blog/css/style.css"></head><body><div class="bg-gradient"></div><div class="bg-pattern"></div><div class="menu-bg"><div class="menu-container"><ul><li class="menu-item"><a href="/hexo-blog/">Home</a></li><li class="menu-item"><a href="/hexo-blog/archives">Archives</a></li><li class="menu-item"><a href="/hexo-blog/about.html">About</a></li><li class="menu-item"><a href="/hexo-blog/tags">Tags</a></li><li class="menu-item"><a href="/hexo-blog/categories">Categories</a></li><li class="menu-item"><a href="/hexo-blog/contact.html">Contact</a></li></ul></div></div><nav><a href="#menu"></a></nav><div class="container"><div class="row"><div class="col-sm-12"><header><div class="logo"><a href="/hexo-blog/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a></div></header><section class="main"><div class="post"><div class="post-header"><h1 class="title"><a href="/hexo-blog/20130413/Python执行系统命令的方法/">Python执行系统命令的方法</a></h1><div class="post-info"><span class="date">2013-04-13</span></div></div><div class="content"><h2 id="1-os-system"><a href="#1-os-system" class="headerlink" title="(1) os.system"></a>(1) os.system</h2><p># 仅仅在一个子终端运行系统命令，而不能获取命令执行后的返回信息</p><p>system(command) -&gt; exit_status<br>Execute the command (a string) in a subshell.</p><p># 如果再命令行下执行，结果直接打印出来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; os.system(&apos;ls&apos;)</span><br><span class="line">04101419778.CHM   bash      document    media      py-django   video</span><br><span class="line">11.wmv            books     downloads   Pictures  python</span><br><span class="line">all-20061022      Desktop   Examples    project    tools</span><br></pre></td></tr></table></figure><h2 id="2-os-popen"><a href="#2-os-popen" class="headerlink" title="(2) os.popen"></a>(2) os.popen</h2><p># 该方法不但执行命令还返回执行后的信息对象</p><p>popen(command [, mode=’r’ [, bufsize]]) -&gt; pipe<br>Open a pipe to/from a command returning a file object.</p><p>例如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; tmp = os.popen(&apos;ls *.py&apos;).readlines()</span><br><span class="line">&gt;&gt;&gt; tmp</span><br><span class="line">Out[21]:</span><br><span class="line">[&apos;dump_db_pickle.py &apos;,</span><br><span class="line">&apos;dump_db_pickle_recs.py &apos;,</span><br><span class="line">&apos;dump_db_shelve.py &apos;,</span><br><span class="line">&apos;initdata.py &apos;,</span><br><span class="line">&apos;__init__.py &apos;,</span><br><span class="line">&apos;make_db_pickle.py &apos;,</span><br><span class="line">&apos;make_db_pickle_recs.py &apos;,</span><br><span class="line">&apos;make_db_shelve.py &apos;,</span><br><span class="line">&apos;peopleinteract_query.py &apos;,</span><br><span class="line">&apos;reader.py &apos;,</span><br><span class="line">&apos;testargv.py &apos;,</span><br><span class="line">&apos;teststreams.py &apos;,</span><br><span class="line">&apos;update_db_pickle.py &apos;,</span><br><span class="line">&apos;writer.py &apos;]</span><br></pre></td></tr></table></figure><p>好处在于：将返回的结果赋于一变量，便于程序的处理。</p><h2 id="3-使用模块-subprocess"><a href="#3-使用模块-subprocess" class="headerlink" title="(3)  使用模块 subprocess"></a>(3) 使用模块 subprocess</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import subprocess</span><br><span class="line">&gt;&gt;&gt; subprocess.call([&quot;cmd&quot;, &quot;arg1&quot;, &quot;arg2&quot;],shell=True)</span><br></pre></td></tr></table></figure><p>获取返回和输出:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">p = subprocess.Popen(<span class="string">'ls'</span>, shell=<span class="keyword">True</span>, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> p.stdout.readlines():</span><br><span class="line">    <span class="keyword">print</span> line,</span><br><span class="line">retval = p.wait()</span><br></pre></td></tr></table></figure><h2 id="4-使用模块-commands"><a href="#4-使用模块-commands" class="headerlink" title="(4)  使用模块 commands"></a>(4) 使用模块 commands</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import commands</span><br><span class="line">&gt;&gt;&gt; dir(commands)</span><br><span class="line">[&apos;__all__&apos;, &apos;__builtins__&apos;, &apos;__doc__&apos;, &apos;__file__&apos;, &apos;__name__&apos;, &apos;getoutput&apos;, &apos;getstatus&apos;,&apos;getstatusoutput&apos;, &apos;mk2arg&apos;, &apos;mkarg&apos;]</span><br><span class="line">&gt;&gt;&gt; commands.getoutput(&quot;date&quot;)</span><br><span class="line">&apos;Wed Jun 10 19:39:57 CST 2009&apos;</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">&gt;&gt;&gt; commands.getstatusoutput(&quot;date&quot;)</span><br><span class="line">(0, &apos;Wed Jun 10 19:40:41 CST 2009&apos;)</span><br></pre></td></tr></table></figure><p>注意： 当执行命令的参数或者返回中包含了中文文字，那么建议使用subprocess，如果使用os.popen则会出现下面的错误:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;./test1.py&quot;, line 56, inmain()</span><br><span class="line">  File &quot;./test1.py&quot;, line 45, in main</span><br><span class="line">    fax.sendFax()</span><br><span class="line">  File &quot;./mailfax/Fax.py&quot;, line 13, in sendFax</span><br><span class="line">    os.popen(cmd)</span><br><span class="line">UnicodeEncodeError: &apos;ascii&apos; codec can&apos;t encode characters in position 46-52: ordinal not inrange(128)</span><br></pre></td></tr></table></figure></div><div class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i> <a href="/hexo-blog/tags/原创/">#原创</a> <a href="/hexo-blog/tags/Python/">#Python</a></div></div></section></div></div></div><div class="push"></div><footer class="footer-content"><div class="container"><div class="row"><div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about"><h2>About</h2><p>This theme was developed by <a href="https://github.com/klugjo">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.</p></div><div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts"><h2>Recent Posts</h2><ul><li><a class="footer-post" href="/hexo-blog/20190107/使用-Devstack-搭建-Openstack-集群/">使用 Devstack 搭建 Openstack</a></li><li><a class="footer-post" href="/hexo-blog/20180725/etcd-集群的备份和还原/">etcd 集群的备份和还原</a></li><li><a class="footer-post" href="/hexo-blog/20180301/Kubernetes-服务灰度升级最佳实践/">Kubernetes 服务灰度升级最佳实践</a></li><li><a class="footer-post" href="/hexo-blog/20180110/从头编写一款时间序列数据库/">从头编写一款时间序列数据库</a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><ul class="list-inline footer-social-icons"><li class="list-inline-item"><a href="https://github.com/whypro"><span class="footer-icon-container"><i class="fa fa-github"></i></span></a></li><li class="list-inline-item"><a href="https://twitter.com/"><span class="footer-icon-container"><i class="fa fa-twitter"></i></span></a></li><li class="list-inline-item"><a href="https://www.facebook.com/"><span class="footer-icon-container"><i class="fa fa-facebook"></i></span></a></li><li class="list-inline-item"><a href="mailto:whypro@live.cn"><span class="footer-icon-container"><i class="fa fa-envelope-o"></i></span></a></li></ul></div></div><div class="row"><div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"><div class="footer-copyright">@Everlasting. All right reserved | Design & Hexo <a href="http://whypro.github.io/hexo-blog/">whypro</a></div></div></div></div></footer><script src="//code.jquery.com/jquery-2.1.4.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script><script src="/hexo-blog/js/main.js"></script></body></html>