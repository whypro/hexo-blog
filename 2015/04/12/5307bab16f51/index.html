<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>用树莓派驱动一个 16×2 的 LCD - 格里莫广场12号</title><link rel="manifest" href="/hexo-blog/manifest.json"><meta name="application-name" content="格里莫广场12号"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="格里莫广场12号"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="原文链接：Mikey Sklar译文链接：http:&amp;#x2F;&amp;#x2F;www.geekfan.net&amp;#x2F;5588&amp;#x2F; 翻译：极客范 - tien    不管什么项目，如果加上一个液晶显示屏的话肯定都会看起来更棒。这篇文章将详解如何用树莓派的六个通用端口（GPIO）来连接一个廉价的HDD44780的小型LCD。当然也有用I2C或是UART来连接LCD的， 但是使用GPIO是最直接的方法。 这种方法的几个优势：  使"><meta property="og:type" content="blog"><meta property="og:title" content="用树莓派驱动一个 16×2 的 LCD"><meta property="og:url" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/"><meta property="og:site_name" content="格里莫广场12号"><meta property="og:description" content="原文链接：Mikey Sklar译文链接：http:&amp;#x2F;&amp;#x2F;www.geekfan.net&amp;#x2F;5588&amp;#x2F; 翻译：极客范 - tien    不管什么项目，如果加上一个液晶显示屏的话肯定都会看起来更棒。这篇文章将详解如何用树莓派的六个通用端口（GPIO）来连接一个廉价的HDD44780的小型LCD。当然也有用I2C或是UART来连接LCD的， 但是使用GPIO是最直接的方法。 这种方法的几个优势：  使"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/fa37675fb05216924dc2e6dbe19ec89b.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/timeip.jpg-1345243868.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/8c9f49c826456da26aaa43c41caf3475.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/3db9e92acf8950c82f66b894aaf9f7ae.gif"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/911af7aa209e00b49f3d6fd2afa92564.png"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/78f0805fa8ffadabda721fdaf85b3ca9.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/7070ba29661c7607983e1339f469f3e7.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/db0c101e83a4d48eea6b4a210f5f9c93.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/ab7e95346facb755fa274b5618717266.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/e95255be208612e8b98c504f3334e78c.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/7884cbea595a4f64acbfc81bb40bf5c1.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/09609cce51d6920fa5433fce90c9c693.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/dd30157fec518880249d8531d5d482d0.gif"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/WP_20140119_004.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/37d6ae252f94bc99c1c822299094e731.jpg"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/631943a50255e09afffbebfc4c1e948b.gif"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/8cfbac32e67b5f21b60dbb00c9cbba50.gif"><meta property="og:image" content="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/544f1443c1250d60cd9b31a0267ba26b.gif"><meta property="article:published_time" content="2015-04-12T07:07:00.000Z"><meta property="article:modified_time" content="2022-11-10T16:19:19.583Z"><meta property="article:author" content="whypro"><meta property="article:tag" content="转载"><meta property="article:tag" content="树莓派"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/hexo-blog/2015/04/12/5307bab16f51/fa37675fb05216924dc2e6dbe19ec89b.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/"},"headline":"用树莓派驱动一个 16×2 的 LCD","image":["http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/fa37675fb05216924dc2e6dbe19ec89b.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/timeip.jpg-1345243868.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/8c9f49c826456da26aaa43c41caf3475.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/3db9e92acf8950c82f66b894aaf9f7ae.gif","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/911af7aa209e00b49f3d6fd2afa92564.png","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/78f0805fa8ffadabda721fdaf85b3ca9.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/7070ba29661c7607983e1339f469f3e7.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/db0c101e83a4d48eea6b4a210f5f9c93.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/ab7e95346facb755fa274b5618717266.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/e95255be208612e8b98c504f3334e78c.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/7884cbea595a4f64acbfc81bb40bf5c1.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/09609cce51d6920fa5433fce90c9c693.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/dd30157fec518880249d8531d5d482d0.gif","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/WP_20140119_004.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/37d6ae252f94bc99c1c822299094e731.jpg","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/631943a50255e09afffbebfc4c1e948b.gif","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/8cfbac32e67b5f21b60dbb00c9cbba50.gif","http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/544f1443c1250d60cd9b31a0267ba26b.gif"],"datePublished":"2015-04-12T07:07:00.000Z","dateModified":"2022-11-10T16:19:19.583Z","author":{"@type":"Person","name":"whypro"},"publisher":{"@type":"Organization","name":"格里莫广场12号","logo":{"@type":"ImageObject","url":"http://whypro.github.io/img/logo.svg"}},"description":"原文链接：Mikey Sklar译文链接：http:&#x2F;&#x2F;www.geekfan.net&#x2F;5588&#x2F; 翻译：极客范 - tien    不管什么项目，如果加上一个液晶显示屏的话肯定都会看起来更棒。这篇文章将详解如何用树莓派的六个通用端口（GPIO）来连接一个廉价的HDD44780的小型LCD。当然也有用I2C或是UART来连接LCD的， 但是使用GPIO是最直接的方法。 这种方法的几个优势：  使"}</script><link rel="canonical" href="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/"><link rel="icon" href="/hexo-blog/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/hexo-blog/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?17e1c6a0010d7be7e49ae6d2c2e7b817";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/hexo-blog/"><img src="/hexo-blog/img/logo.svg" alt="格里莫广场12号" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/hexo-blog/">Home</a><a class="navbar-item" href="/hexo-blog/archives">Archives</a><a class="navbar-item" href="/hexo-blog/categories">Categories</a><a class="navbar-item" href="/hexo-blog/tags">Tags</a><a class="navbar-item" href="/hexo-blog/about.html">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/whypro"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2015-04-12T07:07:00.000Z" title="4/12/2015, 7:07:00 AM">2015-04-12</time></span><span class="level-item">Updated&nbsp;<time datetime="2022-11-10T16:19:19.583Z" title="11/10/2022, 4:19:19 PM">2022-11-11</time></span><span class="level-item">21 minutes read (About 3075 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">用树莓派驱动一个 16×2 的 LCD</h1><div class="content"><blockquote><p>原文链接：<a target="_blank" rel="noopener" href="http://learn.adafruit.com/drive-a-16x2-lcd-directly-with-a-raspberry-pi/%3E">Mikey Sklar</a><br>译文链接：<a target="_blank" rel="noopener" href="http://www.geekfan.net/5588/">http://www.geekfan.net/5588/</a> 翻译：<a target="_blank" rel="noopener" href="http://www.geekfan.net/%3E">极客范</a> - <a target="_blank" rel="noopener" href="http://www.geekfan.net/author/tien/">tien</a></p></blockquote><img src="/hexo-blog/2015/04/12/5307bab16f51/fa37675fb05216924dc2e6dbe19ec89b.jpg"><p>不管什么项目，如果加上一个液晶显示屏的话肯定都会看起来更棒。这篇文章将详解如何用树莓派的六个通用端口（GPIO）来连接一个廉价的HDD44780的小型LCD。当然也有用I2C或是UART来连接LCD的， 但是使用GPIO是最直接的方法。</p><p>这种方法的几个优势：</p><ul><li>使得廉价的LCD得以应用</li><li>不需要I2C的驱动器</li><li>不会占用树莓派仅有的USB口</li></ul><span id="more"></span><p>以下是用Python代码控制显示的时间日期以及IP地址。如果你的树莓派运行在Headless模式下（Headless模式是系统的一种配置模式。在该模式下系统缺少了显示设备、键盘或鼠标），能有个小的显示屏显示IP地址可是很有吸引力的。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/timeip.jpg-1345243868.jpg"><h2 id="以下是完成本次教程的必要硬件"><a href="#以下是完成本次教程的必要硬件" class="headerlink" title="以下是完成本次教程的必要硬件"></a>以下是完成本次教程的必要硬件</h2><ul><li>一个标准的16×2的LCD</li><li>Adafruit Pi Cobbler （树莓派GPIO的扩展设备，这里是以Cobbler为例，当然也可以用树莓派的breakout）</li><li>面包板</li><li>连接线</li><li>一个树莓派</li></ul><p>本教程只适用于16×1, 16×2, 20×2, 20×4 的LCD</p><h2 id="连接Cobbler到LCD上"><a href="#连接Cobbler到LCD上" class="headerlink" title="连接Cobbler到LCD上"></a>连接Cobbler到LCD上</h2><h3 id="LCD"><a href="#LCD" class="headerlink" title="LCD"></a>LCD</h3><img src="/hexo-blog/2015/04/12/5307bab16f51/8c9f49c826456da26aaa43c41caf3475.jpg"><p>任何一个拥有16个引脚的LCD基本上都是用HD44780控制器来控制的。 这种类型的LCD的引脚都拥有相同的输入输出功能，所以比较容易使用。LCD采用的是并行接口，这就意味着树莓派需要提供多个引脚来控制它。本篇教程中我们会用到树莓派的4个数据引脚（4位模式）和两个控制引脚。</p><p>数据引脚可以直接传输数据到LCD上， 这里我们只让LCD处于写模式，不读取任何数据。</p><p>寄存器的选择引脚有两种用途。当设置为低位时，它可以发送指令到LCD（比如显示的位置或是清空屏幕），可理解为命令寄存器。 当设置为高位的时候，它使得LCD转为数据模式并且将数据传输到屏幕上。</p><p>读/写引脚在这里会被设置成低位（写模式），因为我们只是想让LCD作为一个输出设备。</p><p>LCD 各个引脚的定义：</p><ol><li>Ground</li><li>VCC - 5v not 3.3v</li><li>Contrast adjustment (VO) from potentiometer</li><li>Register Select (RS). RS=0: Command, RS=1: Data</li><li>Read/Write (R/W). R/W=0: Write, R/W=1: Read (we won’t use this pin)</li><li>Clock (Enable). Falling edge triggered</li><li>Bit 0 (Not used in 4-bit operation)</li><li>Bit 1 (Not used in 4-bit operation)</li><li>Bit 2 (Not used in 4-bit operation)</li><li>Bit 3 (Not used in 4-bit operation)</li><li>Bit 4</li><li>Bit 5</li><li>Bit 6</li><li>Bit 7</li><li>Backlight LED Anode (+)</li><li>Backlight LED Cathode (-)</li></ol><p>在连接这些引脚之前，先确认你的LCD的背光是否可以正常工作，背光应为LED的背光因为这只需要10－40mA的功率，但是若为EL的背光就需要200mA以上的功率了。EL背光的LCD往往会便宜些但是用起来比较难操作，确保你的LCD不是EL背光，否则会将整个树莓派的功率拖下来。还有一些LCD的LED背光没有自带的稳压电阻，所以在连接前要去确定好你的LCD是否需要加载额外的电阻来保证背光LED正常工作。</p><h3 id="线路图"><a href="#线路图" class="headerlink" title="线路图"></a>线路图</h3><img src="/hexo-blog/2015/04/12/5307bab16f51/3db9e92acf8950c82f66b894aaf9f7ae.gif"><p>首先将Cobber的电源引脚连接到面包板的供电轨上。+5V的用红线连接到红线轨上（译者认为这里连接3.3V的就够了）， GND用黑线连接到蓝线轨上， 为了能使数据传到LCD上，我们将进行以下的连接。</p><ul><li>LCD的Pin 1脚接地(黑线)</li><li>LCD的Pin 2脚接 +5V(红线)</li><li>LCD的Pin 3脚接到分压器的中间位置（橙线）</li><li>LCD的Pin 4脚接到Cobber的 #25位 （黄线）</li><li>LCD的Pin 5脚接地（黑线）</li><li>LCD的Pin 6脚接到Cobber的#24位</li><li>LCD的Pin 7，8，9，10什么都不接</li><li>LCD的Pin 11脚接 Cobber的 ＃23位（蓝线）</li><li>LCD的Pin 12脚接 Cobber的 ＃17位 （紫线）</li><li>LCD的Pin 13脚接 Cobber的 ＃21位 （灰线）（译者推荐这里连接＃18位）</li><li>LCD的Pin 14脚接 Cobber的 ＃22位 （白线）</li><li>LCD的Pin 15脚接 +5V（红线）</li><li>LCD的Pin 16脚接地 （黑线）</li></ul><p>分压器左边的引脚接地（黑线），右边的引脚接+5V（红线）。</p><h3 id="原理图"><a href="#原理图" class="headerlink" title="原理图"></a>原理图</h3><img src="/hexo-blog/2015/04/12/5307bab16f51/911af7aa209e00b49f3d6fd2afa92564.png"><h3 id="5V-LCD-vs-3-3V-Pi"><a href="#5V-LCD-vs-3-3V-Pi" class="headerlink" title="5V LCD vs 3.3V Pi"></a>5V LCD vs 3.3V Pi</h3><p>树莓派配置的通用接口（GPIO）为3.3V，但是我们的LCD是需要5V配电的设备。如果我们仅仅是用LCD做树莓派的输出设备的话，连接5V的引脚当然没有问题。所以我们这里不使用Cobbler上3.3V的Pin口，并且我们将LCD上的RW（读写）脚接地，这样就避免了LCD向树莓派发送+5V的信号。</p><h3 id="准备LCD"><a href="#准备LCD" class="headerlink" title="准备LCD"></a>准备LCD</h3><p>在你开始前，确认你有一组 0.1“规格的引脚和一个阻值为10K的分压器。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/78f0805fa8ffadabda721fdaf85b3ca9.jpg"><p>大部分LCD显示屏是需要16个引脚的，如果头部太长，可以适当剪短到合适的长度即可。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/7070ba29661c7607983e1339f469f3e7.jpg"><p>接着你需要将引脚和LCD焊接到一起。你必须这么做，不能只是扣上去就完事了。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/db0c101e83a4d48eea6b4a210f5f9c93.jpg"><p>首先将Cobbler上的+5V引脚跟GND引脚连接到面包板上。接着如图连接LCD的Pin1脚、Pin2脚、Pin15脚和Pin16脚连接到面包板的供电轨上。这个时候LCD的背光应该就亮了，如果没有亮请检查你的线路是否连接正常。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/ab7e95346facb755fa274b5618717266.jpg"> <img src="/hexo-blog/2015/04/12/5307bab16f51/e95255be208612e8b98c504f3334e78c.jpg"><p>接着，将分压器中间的引脚按图中所示连接到LCD的Pin脚3上，其他两个引脚分别连接5V电源和地线。</p><p>扭动分压器直到LCD的第一行显示出方块来。如果看不到，检查一下线路是否连接正确。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/7884cbea595a4f64acbfc81bb40bf5c1.jpg"><p>按照电路图所示完成LCD最后RS（Pin 4脚），RW（Pin 5脚）， EN（Pin 6脚）， D4（Pin 11脚）， D5（Pin 12脚）， D6（Pin 13脚）和D7（Pin 14脚）的连接。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/09609cce51d6920fa5433fce90c9c693.jpg"><p>到这里，就可以用Python脚本来驱动LCD显示些东西了。</p><h2 id="必要的Python包"><a href="#必要的Python包" class="headerlink" title="必要的Python包"></a>必要的Python包</h2><p>本教程是基于Debian的Wheezy系统写成的。必须要安装以下组件才能使用树莓派的GPIO口。</p><p>安装python（2.x）的最新开发套件：</p><img src="/hexo-blog/2015/04/12/5307bab16f51/dd30157fec518880249d8531d5d482d0.gif"><p>安装如下组件：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-setuptools</span><br><span class="line">sudo easy_install -U distribute </span><br><span class="line">sudo apt-get install python-pip</span><br></pre></td></tr></table></figure><p>安装 RPi.GPIO 0.3.1a:</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install rpi.gpio</span><br></pre></td></tr></table></figure><h2 id="Python脚本"><a href="#Python脚本" class="headerlink" title="Python脚本"></a>Python脚本</h2><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>可以在Github获得控制LCD的Python脚本。其中包括两个文件：</p><ol><li>Adafruit_CharLCD.py —该文件中包含用来控制LCD的Python类</li><li>Adafruit_CharLCD_IPclock_example.py — 样例程序，用来显示IP地址、日期时间。</li></ol><p>第一个文件Adafruit_CharLCD.py将两个LCD的控制代码混合在了一起。感谢Github上的用户lrvick，他用一个Python类将它们漂亮的封装在一起。</p><p>将代码加载到树莓派上的最简单的方法就是将树莓派连上网络，然后直接通过git的clone命令来下载。只要在合适的目录下（比如说/home/pi/）键入以下命令即可：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apt-get install git</span><br><span class="line">git <span class="built_in">clone</span> http://github.com/adafruit/Adafruit-Raspberry-Pi-Python-Code.git</span><br><span class="line"><span class="built_in">cd</span> Adafruit-Raspberry-Pi-Python-Code</span><br><span class="line"><span class="built_in">cd</span> Adafruit_CharLCD</span><br></pre></td></tr></table></figure><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>现在你就可以测试之前连接好的线路了，只要简单运行Python代码Adafruit_CharLCD.py即可。因为这里的代码很少，它只会简单的显示出一段测试消息。</p><p>无论你使用的是什么型号的树莓派，译者在这里建议大家将引脚21替换换为引脚18， 所以这里要对 Adafruit_CharLCD.py做一个小小的改动，将：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, pin_rs=<span class="number">25</span>, pin_e=<span class="number">24</span>, pins_db=[<span class="number">23</span>, <span class="number">17</span>, <span class="number">21</span>, <span class="number">22</span>], GPIO = <span class="literal">None</span></span>):</span></span><br></pre></td></tr></table></figure><p>修改为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, pin_rs=<span class="number">25</span>, pin_e=<span class="number">24</span>, pins_db=[<span class="number">23</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">22</span>], GPIO = <span class="literal">None</span></span>):</span></span><br></pre></td></tr></table></figure><p>可以使用nano编辑器来修改代码。</p><p>下图为译者按照参考进行的试验，整体进行很顺利，提醒一下译者连接的时候就是用的树莓派的Pin #18口 而不是原文作者使用的#21或者#27。（顺便让译者的小黄人stuart也上一下镜，希望大家喜欢 :D ）</p><img src="/hexo-blog/2015/04/12/5307bab16f51/WP_20140119_004.jpg"><h3 id="IP和时钟的显示"><a href="#IP和时钟的显示" class="headerlink" title="IP和时钟的显示"></a>IP和时钟的显示</h3><p>这个脚本的功能是显示你的IP地址，若想显示无线接口的IP地址，请将代码中的eth0替换为wlan0或者wlan1即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Adafruit_CharLCD <span class="keyword">import</span> Adafruit_CharLCD</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep, strftime</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">lcd = Adafruit_CharLCD()</span><br><span class="line"></span><br><span class="line">cmd = <span class="string">&quot;ip addr show eth0 | grep inet | awk &#x27;&#123;print $2&#125;&#x27; | cut -d/ -f1&quot;</span></span><br><span class="line"></span><br><span class="line">lcd.begin(<span class="number">16</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_cmd</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    p = Popen(cmd, shell=<span class="literal">True</span>, stdout=PIPE)</span><br><span class="line">    output = p.communicate()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    lcd.clear()</span><br><span class="line">    ipaddr = run_cmd(cmd)</span><br><span class="line">    lcd.message(datetime.now().strftime(<span class="string">&#x27;%b %d  %H:%M:%S\n&#x27;</span>))</span><br><span class="line">    lcd.message(<span class="string">&#x27;IP %s&#x27;</span> % ( ipaddr ) )</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><h3 id="运行代码"><a href="#运行代码" class="headerlink" title="运行代码"></a>运行代码</h3><p>运行代码很简单，直接输入下列命令即可。注意脚本的权限问题，可用chmod +x命令修改为可执行。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./Adafruit_CharLCD_IPclock_example.py</span><br></pre></td></tr></table></figure><h3 id="显示结果如下"><a href="#显示结果如下" class="headerlink" title="显示结果如下"></a>显示结果如下</h3><img src="/hexo-blog/2015/04/12/5307bab16f51/37d6ae252f94bc99c1c822299094e731.jpg"><h2 id="初始化脚本"><a href="#初始化脚本" class="headerlink" title="初始化脚本"></a>初始化脚本</h2><p>能成功显示出时间和IP地址固然很好，但是这需要我们手动去启动 <code>Adafruit_CharLCD_IPclock_example.py</code> 若是能在每次树莓派启动时，都能运行这个Python程序的话就会方便很多。下面我们将设置 <code>Adafruit_CharLCD_IPclock_example.py</code> 为开机自启动，而在关机时会自动关闭。</p><p>将下段代码粘贴到 <code>/etc/init.d/lcd</code>，注意，需要 <code>root</code> 权限才能在这个目录下执行写操作。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">### BEGIN INIT INFO</span></span><br><span class="line"><span class="comment"># Provides: LCD - date / time / ip address</span></span><br><span class="line"><span class="comment"># Required-Start: $remote_fs $syslog</span></span><br><span class="line"><span class="comment"># Required-Stop: $remote_fs $syslog</span></span><br><span class="line"><span class="comment"># Default-Start: 2 3 4 5</span></span><br><span class="line"><span class="comment"># Default-Stop: 0 1 6</span></span><br><span class="line"><span class="comment"># Short-Description: Liquid Crystal Display</span></span><br><span class="line"><span class="comment"># Description: date / time / ip address</span></span><br><span class="line"><span class="comment">### END INIT INFO</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#! /bin/sh</span></span><br><span class="line"><span class="comment"># /etc/init.d/lcd</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> HOME</span><br><span class="line"><span class="keyword">case</span> <span class="string">&quot;<span class="variable">$1</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">    start)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Starting LCD&quot;</span></span><br><span class="line">        /home/pi/Adafruit-Raspberry-Pi-Python-Code/Adafruit_CharLCD/Adafruit_CharLCD_IPclock_example.py  2&gt;&amp;1 &amp;</span><br><span class="line">    ;;</span><br><span class="line">    stop)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Stopping LCD&quot;</span></span><br><span class="line">    LCD_PID=`ps auxwww | grep Adafruit_CharLCD_IPclock_example.py | head -1 | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>`</span><br><span class="line">    <span class="built_in">kill</span> -9 <span class="variable">$LCD_PID</span></span><br><span class="line">    ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;Usage: /etc/init.d/lcd &#123;start|stop&#125;&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure><p>你需要相应的将路径修改为你实际保存该脚本的路径才行。</p><p>修改初始化脚本的执行权限：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x /etc/init.d/lcd</span><br></pre></td></tr></table></figure><p>用 <code>update-rc.d</code> 命令使系统感知lcd初始化脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-rc.d lcd defaults</span><br></pre></td></tr></table></figure><img src="/hexo-blog/2015/04/12/5307bab16f51/631943a50255e09afffbebfc4c1e948b.gif"><p>现在每次启动树莓派的时候lcd也会自动启动并显示出系统的时间和IP地址到屏幕上。这样你就可以在不用屏幕显示器的情况下知道树莓派的IP地址以及何时可以连接上它。</p><h2 id="时区"><a href="#时区" class="headerlink" title="时区"></a>时区</h2><p>最后但也是最重要的是：我的树莓派是按世界统一时间（UTC）配置的，但是我想让它显示出我所在的本地时间。以下命令可将树莓派设定为任意时区的本地时间，这个命令是一次性的，一旦完成设定，重启之后也不会失效。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg-reconfigure tzdata</span><br></pre></td></tr></table></figure><img src="/hexo-blog/2015/04/12/5307bab16f51/8cfbac32e67b5f21b60dbb00c9cbba50.gif"><p>指令输入之后会转到一个选择时间域的程序，下移光标选择你所在的时区就可以了。</p><img src="/hexo-blog/2015/04/12/5307bab16f51/544f1443c1250d60cd9b31a0267ba26b.gif"></div><div class="article-licensing box"><div class="licensing-title"><p>用树莓派驱动一个 16×2 的 LCD</p><p><a href="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/">http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>whypro</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2015-04-12</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2022-11-11</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/hexo-blog/tags/%E8%BD%AC%E8%BD%BD/">转载</a><a class="link-muted mr-2" rel="tag" href="/hexo-blog/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/">树莓派</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/hexo-blog/2015/04/13/3e4cb28a149a/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">使用 dd 命令测试 USB 和 SSD 硬盘的读写速度</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/hexo-blog/2015/04/08/de2fd959342c/"><span class="level-item">使用 Python 进行并发编程</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="http://whypro.github.io/hexo-blog/2015/04/12/5307bab16f51/",this.page.identifier="2015/04/12/5307bab16f51/"};!function(){var e=document,t=e.createElement("script");t.src="//hexo-blog-everlasting.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#以下是完成本次教程的必要硬件"><span class="level-left"><span class="level-item">1</span><span class="level-item">以下是完成本次教程的必要硬件</span></span></a></li><li><a class="level is-mobile" href="#连接Cobbler到LCD上"><span class="level-left"><span class="level-item">2</span><span class="level-item">连接Cobbler到LCD上</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#LCD"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">LCD</span></span></a></li><li><a class="level is-mobile" href="#线路图"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">线路图</span></span></a></li><li><a class="level is-mobile" href="#原理图"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">原理图</span></span></a></li><li><a class="level is-mobile" href="#5V-LCD-vs-3-3V-Pi"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">5V LCD vs 3.3V Pi</span></span></a></li><li><a class="level is-mobile" href="#准备LCD"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">准备LCD</span></span></a></li></ul></li><li><a class="level is-mobile" href="#必要的Python包"><span class="level-left"><span class="level-item">3</span><span class="level-item">必要的Python包</span></span></a></li><li><a class="level is-mobile" href="#Python脚本"><span class="level-left"><span class="level-item">4</span><span class="level-item">Python脚本</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#代码"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">代码</span></span></a></li><li><a class="level is-mobile" href="#测试"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">测试</span></span></a></li><li><a class="level is-mobile" href="#IP和时钟的显示"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">IP和时钟的显示</span></span></a></li><li><a class="level is-mobile" href="#运行代码"><span class="level-left"><span class="level-item">4.4</span><span class="level-item">运行代码</span></span></a></li><li><a class="level is-mobile" href="#显示结果如下"><span class="level-left"><span class="level-item">4.5</span><span class="level-item">显示结果如下</span></span></a></li></ul></li><li><a class="level is-mobile" href="#初始化脚本"><span class="level-left"><span class="level-item">5</span><span class="level-item">初始化脚本</span></span></a></li><li><a class="level is-mobile" href="#时区"><span class="level-left"><span class="level-item">6</span><span class="level-item">时区</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/hexo-blog/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2022-05-17T12:25:00.000Z">2022-05-17</time></p><p class="title"><a href="/hexo-blog/2022/05/17/b63e8542ccf9/">我的 NAS 方案（硬件篇）</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-07-08T14:55:25.000Z">2021-07-08</time></p><p class="title"><a href="/hexo-blog/2021/07/08/25a9802738a4/">《Google SRE 工作手册》阅读笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-03-06T10:48:51.000Z">2021-03-06</time></p><p class="title"><a href="/hexo-blog/2021/03/06/cfed8bb002af/">在本地运行 Kubernetes e2e 测试</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-07T15:36:11.000Z">2021-02-07</time></p><p class="title"><a href="/hexo-blog/2021/02/07/6fae89e75555/">Kubernetes 快速部署方法</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-07T15:13:01.000Z">2021-02-07</time></p><p class="title"><a href="/hexo-blog/2021/02/07/2c57d2981d19/">基于 KVM 的开发环境搭建</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/hexo-blog/"><img src="/hexo-blog/img/logo.svg" alt="格里莫广场12号" height="28"></a><p class="is-size-7"><span>&copy; 2023 whypro</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/whypro"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!1,fold:"unfolded"}}}</script><script src="/hexo-blog/js/column.js"></script><script src="/hexo-blog/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/hexo-blog/js/back_to_top.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><script src="/hexo-blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/hexo-blog/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/hexo-blog/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>